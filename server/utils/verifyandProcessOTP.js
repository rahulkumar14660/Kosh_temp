import ErrorHandler from "../middlewares/error.middleware.js";import { User } from "../models/user.model.js";import { checkInvalidOrExpiredOTP } from "./checkInvalidorExpiredOTP.js";export const verifyandProcessOTP = async (email, otp, next, checkVerified) => {  if (!email || !otp)    return next(new ErrorHandler("Email and otp are required", 400));  const user = await User.findOne({ email }).select(    "+verificationCode +verificationCodeExpires"  );  if (!user) return next(new ErrorHandler("User not found", 404));  if (checkVerified) {    if (user.accountVerified)      return next(new ErrorHandler("User already verified", 400));  }  if (checkInvalidOrExpiredOTP(user, otp)) {    return next(new ErrorHandler("Invalid or expired OTP", 400));  }  user.accountVerified = true;  user.verificationCode = undefined;  user.verificationCodeExpired = undefined;  await user.save();  return user;};